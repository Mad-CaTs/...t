<!-- Card para Compuesto -->
<div *ngIf="typeOfRange === 'Composite'" class="Zborder-0 shadow p-3 conteniner-gradient"
    [style.background]="typeOfLevel === 'Current' ? getGradientColor(rangeData?.idRange) : getGradientColor(nextRangeData?.idNextCompoundRange)"
    style="width: 100%">
    <!-- Header con rango y badge -->
    <div class="card-header bg-transparent border-0 mb-4 w-100">
        <div class="d-flex justify-content-between align-items-center gap-4">
            <div class="d-flex align-items-center gap-2">
                <div *ngIf="cardLoading" class="d-flex justify-content-center align-items-center ps-4">

                </div>
                <ng-container *ngIf="!cardLoading">
                    <img [src]="
                        'https://s3.us-east-2.amazonaws.com/backoffice.documents/Ranges/' +
                        (typeOfLevel === 'Current' ? imageRange : nextRangeImage) + '.png'
                    " alt="Rango Actual" style="width: 41px; height: 41px" />
                    <h5 class="mb-0 fs-5 rank-title fw-medium"
                        [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                        Rango {{ typeOfLevel === 'Current' ? range : nextRange }}
                    </h5>
                </ng-container>
            </div>
            <ng-container *ngIf="!cardLoading">
                <span class="badge px-3 py-2 rounded-5"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.border]=" '1px solid ' + (typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange))">
                    {{ currentRangeTitle }}
                </span>
            </ng-container>
        </div>
    </div>

    <!-- Contenido para Current -->
    <ng-container *ngIf="cardLoading">
        <div class="progress-spinner-container">
            <p-progressSpinner [style]="{ width: '10rem', height: '3rem' }"></p-progressSpinner>
        </div>
    </ng-container>
    <ng-container *ngIf="!cardLoading">
        <div *ngIf="typeOfLevel === 'Current'">
            <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
                [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange, 0.7) : getColorByRangeId(nextRangeData?.idNextCompoundRange,0.9))">
                <span class="fw-medium">
                    <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesActualRange?.pointsRama1CompundRange
                        }}
                        pts</strong>
                    de {{ pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximoCompound || pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximo }} puntos
                </span>
                <span class="fw-normal p-1 shadow rounded-1"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                    Volumen rama 1
                </span>
            </div>
            <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
                [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange))">
                <span class="fw-medium">
                    <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesActualRange?.pointsRama2CompundRange
                        }}
                        pts</strong>
                    de {{ pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximoCompound || pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximo }} puntos
                </span>
                <span class="fw-normal p-1 shadow rounded-1"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                    Volumen rama 2
                </span>
            </div>
            <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
                [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange))">
                <span class="fw-medium">
                    <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesActualRange?.pointsRama3CompundRange
                        }}
                        pts</strong>
                    de {{ pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximoCompound || pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximo }} puntos
                </span>
                <span class="fw-normal p-1 shadow rounded-1"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                    Volumen rama 3
                </span>
            </div>
            <div class="d-flex flex-column align-items-start p-2 py-3 gap-3">
                <span class="fw-medium">
                    <strong class="fs-5">{{ volumnDirectRamCompound }}
                        pts</strong>
                    de {{ pointRangesDataToChild[0]?.percentagesActualRange?.volumeDirectCompoundRange }} puntos
                </span>
                <span class="fw-normal p-1 shadow rounded-1"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                    Volumen Directo
                </span>
            </div>
        </div>
    </ng-container>

    <!-- Contenido para Next -->
    <ng-container *ngIf="!cardLoading">

        <div *ngIf="typeOfLevel === 'Next'">
            <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
                [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange))">
                <span class="fw-medium">
                    <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesNextRange?.pointsRama1CompundRange ||
                        0 }}
                        pts</strong>
                    de {{ pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximoCompound || pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximo || 0 }} puntos
                </span>
                <span class="fw-normal p-1 shadow rounded-1"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                    Volumen rama 1
                </span>
            </div>
            <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
                [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange))">
                <span class="fw-medium">
                    <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesNextRange?.pointsRama2CompundRange ||
                        0 }}
                        pts</strong>
                    de {{ pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximoCompound || pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximo || 0 }} puntos
                </span>
                <span class="fw-normal p-1 shadow rounded-1"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                    Volumen rama 2
                </span>
            </div>
            <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
                [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange))">
                <span class="fw-medium">
                    <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesNextRange?.pointsRama3CompundRange ||
                        0 }}
                        pts</strong>
                    de {{ pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximoCompound || pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximo || 0 }} puntos
                </span>
                <span class="fw-normal p-1 shadow rounded-1"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                    Volumen rama 3
                </span>
            </div>
            <div class="d-flex flex-column align-items-start p-2 py-3 gap-3">
                <span class="fw-medium">
                    <strong class="fs-5">{{ volumnNextDirectRamCompound || 0
                        }} pts</strong>
                    de {{ pointRangesDataToChild[0]?.percentagesNextRange?.volumeDirectCompoundRange || 0 }} puntos
                </span>
                <span class="fw-normal p-1 shadow rounded-1"
                    [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRange) : getColorByRangeId(nextRangeData?.idNextCompoundRange)"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRange) : getTextColorByRangeId(nextRangeData?.idNextCompoundRange)">
                    Volumen Directo
                </span>
            </div>
        </div>
    </ng-container>
</div>

<!-- Card para Residual -->
<div *ngIf="typeOfRange === 'Residual'" class="Zborder-0 shadow p-3 conteniner-gradient"
    [style.background]="typeOfLevel === 'Current' ? getGradientColor(rangeData?.idRangeResidual) : getGradientColor(nextRangeData?.idNextResidualRange)"
    style="width: 100%">
    <!-- Header con rango y badge -->
    <div class="card-header bg-transparent border-0 mb-4 w-100">
        <div class="d-flex justify-content-between align-items-center gap-4">
            <div class="d-flex align-items-center gap-2">
                <div *ngIf="isLoading" class="d-flex justify-content-center align-items-center ps-4">
                    <p-progressSpinner [style]="{ width: '2.2rem', height: '2.2rem' }"></p-progressSpinner>
                </div>
                <ng-container *ngIf="!isLoading">
                    <img [src]="
                        'https://s3.us-east-2.amazonaws.com/backoffice.documents/Ranges/' +
                        (typeOfLevel === 'Current' ? imageRange : nextRangeImage) + '.png'
                    " alt="Rango Actual" style="width: 41px; height: 41px" />
                </ng-container>
                <h5 class="mb-0 fs-5 rank-title fw-medium"
                    [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                    Rango {{ typeOfLevel === 'Current' ? range : nextRange }}
                </h5>
            </div>
            <span class="badge px-3 py-2 rounded-5"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.border]=" '1px solid ' + (typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange))">
                {{ currentRangeTitle }}
            </span>
        </div>
    </div>

    <!-- Contenido para Current -->
    <div *ngIf="typeOfLevel === 'Current'" class="w-100">
        <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
            [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual, 0.7) : getColorByRangeId(nextRangeData?.idNextResidualRange,0.9))">
            <span class="fw-medium">
                <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesActualRange?.pointsRama1ResidualRange }}
                    pts</strong>
                de {{ pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximoResidual }} puntos
            </span>
            <span class="fw-normal p-1 shadow rounded-1"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                Volumen rama 1
            </span>
        </div>
        <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
            [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange))">
            <span class="fw-medium">
                <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesActualRange?.pointsRama2ResidualRange }}
                    pts</strong>
                de {{ pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximoResidual }} puntos
            </span>
            <span class="fw-normal p-1 shadow rounded-1"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                Volumen rama 2
            </span>
        </div>
        <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
            [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange))">
            <span class="fw-medium">
                <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesActualRange?.pointsRama3ResidualRange }}
                    pts</strong>
                de {{ pointRangesDataToChild[0]?.percentagesActualRange?.pointMaximoResidual }} puntos
            </span>
            <span class="fw-normal p-1 shadow rounded-1"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                Volumen rama 3
            </span>
        </div>
        <div class="d-flex flex-column align-items-start p-2 py-3 gap-3">
            <span class="fw-medium">
                <strong class="fs-5">{{ volumnDirectRamResidual }}
                    pts</strong>
                de {{ pointRangesDataToChild[0]?.percentagesActualRange?.volumeDirectResidualRange }} puntos
            </span>
            <span class="fw-normal p-1 shadow rounded-1"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                Volumen Directo
            </span>
        </div>
    </div>

    <!-- Contenido para Next -->
    <div *ngIf="typeOfLevel === 'Next'" class="w-100">
        <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
            [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange))">
            <span class="fw-medium">
                <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesNextRange?.pointsRama1ResidualRange }}
                    pts</strong>
                de {{ pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximoResidual || 0 }} puntos
            </span>
            <span class="fw-normal p-1 shadow rounded-1"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                Volumen rama 1
            </span>
        </div>
        <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
            [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange))">
            <span class="fw-medium">
                <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesNextRange?.pointsRama2ResidualRange }}
                    pts</strong>
                de {{ pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximoResidual || 0 }} puntos
            </span>
            <span class="fw-normal p-1 shadow rounded-1"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                Volumen rama 2
            </span>
        </div>
        <div class="d-flex flex-column align-items-start p-2 py-3 gap-3"
            [style.borderBottom]="sizeOfBorderButton + 'px solid ' + (typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange))">
            <span class="fw-medium">
                <strong class="fs-5">{{ pointRangesDataToChild[0]?.percentagesNextRange?.pointsRama3ResidualRange }}
                    pts</strong>
                de {{ pointRangesDataToChild[0]?.percentagesNextRange?.pointMaximoResidual || 0 }} puntos
            </span>
            <span class="fw-normal p-1 shadow rounded-1"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                Volumen rama 3
            </span>
        </div>
        <div class="d-flex flex-column align-items-start p-2 py-3 gap-3">
            <span class="fw-medium">
                <strong class="fs-5">{{ volumnNextDirectRamResidual }}
                    pts</strong>
                de {{ pointRangesDataToChild[0]?.percentagesNextRange?.volumeDirectResidualRange }} puntos
            </span>
            <span class="fw-normal p-1 shadow rounded-1"
                [style.background]="typeOfLevel === 'Current' ? getColorByRangeId(rangeData?.idRangeResidual) : getColorByRangeId(nextRangeData?.idNextResidualRange)"
                [style.color]="typeOfLevel === 'Current' ? getTextColorByRangeId(rangeData?.idRangeResidual) : getTextColorByRangeId(nextRangeData?.idNextResidualRange)">
                Volumen Directo
            </span>
        </div>
    </div>
</div>