<div class="container-primary">
  <div class="container-description">
    <!-- <app-profile-dashboard-header [isLoading]="isLoading" [memberships]="result?.products"
      [allNearExpiration]="result?.allNearExpiration" [investorPoints]="investorPoints" [result]="result?.result"
      profileTitle="Emabajador" [tabs]="tabs"></app-profile-dashboard-header> -->
    <app-profile-dashboard-header profileTitle="Emabajador" [tabs]="tabs"></app-profile-dashboard-header>
    <app-main-ambassador [colors]="colors" [pointRangesDataToChild]="pointRangesDataToChild"
      [nextRangeData]="nextRangeData" [rangeData]="rangeData" [getColorByRangeId]="getColorByRangeId.bind(this)"
      [getTextColorByRangeId]="getTextColorByRangeId.bind(this)" [getGradientColor]="getGradientColor.bind(this)"
      [formatRangeName]="formatRangeName.bind(this)" [volTotal]="volCtotal"
      [puntajeDeLaMembresia]="puntajeDeLaMembresia" [numberTotal]="numberOfUsers"
      (pointsUpdated)="onPointsUpdated($event)" (updateTab)="onTabChanged($event)" [cardLoading]="isLoading"></app-main-ambassador>
  </div>
  <div class="container-back-range">
    <div class="container-range">

      <ng-container *ngIf="isLoading">
        <div class="progress-spinner-container">
          <p-progressSpinner [style]="{ width: '2rem', height: '2rem' }"></p-progressSpinner>
        </div>
      </ng-container>

      <ng-container *ngIf="!isLoading">
        <div class="d-flex flex-row justify-content-between align-items-center w-100">
          <h2 class="fs-3 fw-normal mb-0">Mis rangos</h2>
          <span class="p-1 rounded-4 px-2 custom-color-range">Rango {{ currentTabState ? 'Compuesto' : 'Residual'
            }}</span>
        </div>
        <div class="d-flex flex-row justify-content-start gap-4 align-items-center p-3 rounded-4 shadow-sm"
          [style.background]="getGradientColor(currentTabState ? rangeData?.idMaxCompoundRange : rangeData?.idMaxResidualRange)">

          <img [src]="
        'https://s3.us-east-2.amazonaws.com/backoffice.documents/Ranges/' +
          formatRangeName(currentTabState ? rangeData?.maxCompoundRange : rangeData?.maxResidualRange)+ '.png'
                    " alt="Maximo logro" class="img-custom" />
          <div class="p-1 d-flex flex-column align-items-start">
            <h2 class="fs-4"
              [style.color]="getTextColorByRangeId(currentTabState ? rangeData?.idMaxCompoundRange : rangeData?.idMaxResidualRange)">
              {{
              currentTabState ? rangeData?.maxCompoundRange : rangeData?.maxResidualRange }} </h2>
            <span
              [style.color]="getTextColorByRangeId(currentTabState ? rangeData?.idMaxCompoundRange : rangeData?.idMaxResidualRange )">Maximo
              logro</span>
          </div>
        </div>
        <div class="d-flex flex-row justify-content-start gap-4 align-items-center p-3 rounded-4 shadow-sm"
          [style.background]="getGradientColor(currentTabState ? rangeData?.idRange : rangeData?.idRangeResidual)">
          <img [src]="
        'https://s3.us-east-2.amazonaws.com/backoffice.documents/Ranges/' +
          formatRangeName(currentTabState ? rangeData?.rango : rangeData?.rangoResidual)+ '.png'
                    " alt="Rango Actual" class="img-custom" />
          <div class="p-1 d-flex flex-column align-items-start">
            <h2 class="fs-4" [style.color]="getTextColorByRangeId(currentTabState ? rangeData?.idRange : rangeData?.idRangeResidual)">{{ currentTabState ? rangeData?.rango : rangeData?.rangoResidual }}</h2>
            <span [style.color]="getTextColorByRangeId(currentTabState ? rangeData?.idRange : rangeData?.idRangeResidual)">Rango actual</span>
          </div>
        </div>

        <div class="p-2 shadow-sm rounded-3 bg-white-lilac py-3 px-3">
          <div class="d-flex flex-row justify-content-between align-items-center">
            <h2 class="fs-6 fw-normal mb-0">Proximo logro</h2>
            <div class="p-1 d-flex flex-row justify-content-center align-items-center gap-1 px-2 rounded-3"
              [style.background]="getGradientColor(currentTabState ? nextRangeData?.idNextCompoundRange : nextRangeData?.idNextResidualRange)">
              <h2 class="fs-6 mb-0 p-1" [style.color]="getTextColorByRangeId(currentTabState ? nextRangeData?.idNextCompoundRange : nextRangeData?.idNextResidualRange)">Rango
                {{ currentTabState ? nextRangeData?.nextCompoundRange : nextRangeData?.nextResidualRange }}</h2>
              <img [src]="
        'https://s3.us-east-2.amazonaws.com/backoffice.documents/Ranges/' +
          formatRangeName(currentTabState ? nextRangeData?.nextCompoundRange : nextRangeData?.nextResidualRange)+ '.png'
                    " alt="Maximo logro" class="img-compound-range" />
            </div>
          </div>
          <div class="container-progressbar">
            <mat-progress-bar [value]="averagePercentage" mode="determinate" class="custom-progress-bar">
            </mat-progress-bar>
            <span class="average text-muted">
              {{ averagePercentage }}%
            </span>
            <span class="meta text-muted">
              Meta: 100%
            </span>
          </div>
        </div>
        <div class="border p-3 rounded-4">
          <h3 class="mb-3 fw-normal fs-5 border-bottom p-2">Puntos totales</h3>

          <div class="min-container">
            <div class="volumen-rama-custom">
              <span>Volumen Rama 1</span>
              <span>{{ currentTabState ? compuestoRama1 : residualRama1 }} pts</span>
            </div>
            <mat-progress-bar [value]="currentTabState ? compuestoRama1 : residualRama1" mode="determinate" class="custom-progress-bar">
            </mat-progress-bar>
          </div>
          <div class="min-container">
            <div class="volumen-rama-custom">
              <span>Volumen Rama 2</span>
              <span>{{ currentTabState ?compuestoRama2 : residualRama2 }} pts</span>
            </div>
            <mat-progress-bar [value]="currentTabState ? compuestoRama2 : residualRama2" mode="determinate" class="custom-progress-bar">
            </mat-progress-bar>
          </div>
          <div class="min-container">
            <div class="d-flex justify-content-between align-items-center">
              <span>Volumen Rama 3</span>
              <span>{{ currentTabState ? compuestoRama3 : residualRama3 }} pts</span>
            </div>
            <mat-progress-bar [value]="currentTabState ? compuestoRama3 : residualRama3" mode="determinate" class="custom-progress-bar">
            </mat-progress-bar>
          </div>
          <div class="min-container">
            <div class="volumen-rama-custom">
              <span>Volumen Directo</span>
              <span>{{ currentTabState ? cTotal : rTotal}} pts</span>
            </div>
            <mat-progress-bar [value]="currentTabState ? cTotal : rTotal" mode="determinate" class="custom-progress-bar">
            </mat-progress-bar>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>