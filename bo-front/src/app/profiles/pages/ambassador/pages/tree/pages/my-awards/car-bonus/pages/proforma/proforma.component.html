<div class="proforma-card">
	<div class="proforma-header">
		<h1 class="proforma-heading">Proforma</h1>
		<button class="add-proforma-btn" (click)="onAdd()">
			<span class="plus">+</span>
			<span class="label">AÃ±adir proforma</span>
		</button>
	</div>

	<div class="toolbar-card">
		<ng-container *ngIf="proformas?.length; else noProformas">
			<ng-container *ngFor="let p of proformas; let i = index">
				<ng-container *ngIf="p.items?.length">
					<div class="proforma-item">
						<div class="proforma-title">{{ p.nombre || 'Proforma ' + p.id }}</div>
						<div class="proforma-table-wrapper" [class.with-gap]="i < proformas.length - 1">
							<app-table-generic
								[columns]="columns"
								[keys]="keys"
								[data]="p.items"
								[columnWidths]="columnWidths"
								[showEdit]="true"
								[showDelete]="true"
								(edit)="onEdit(p, $event)"
								(delete)="onDelete(p, $event)"
								(view)="onView(p, $event)"
							></app-table-generic>
						</div>
					</div>
				</ng-container>
			</ng-container>
		</ng-container>

		<ng-template #noProformas>
			<div class="no-proformas">No hay proformas disponibles.</div>
		</ng-template>

			<div class="informative-banner">
				<div class="banner-inner">
					<div class="info-icon">i</div>
					<div class="info-text">
						Recuerda: Puedes eliminar o editar tus proformas hasta el 30 de septiembre de 2025.
					</div>
				</div>
			</div>

				<!-- Modales: confirm delete y notify -->
				<app-modal-confirm-delete
					*ngIf="showConfirm"
					[title]="confirmTitle"
					[message]="confirmMessage"
					(confirm)="onConfirmDelete()"
					(cancel)="onCancelDelete()"
				></app-modal-confirm-delete>

				<app-modal-notify
					*ngIf="showNotify"
					[title]="notifyTitle"
					[message]="notifyMessage"
					[iconType]="notifyIcon"
					(closed)="onCloseNotify()"
				></app-modal-notify>
	</div>
</div>
