<guest-panels [panel]="myPassword">
  <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()" class="password-form">
    <div class="form-group form-group-custom form-row">
      <div>
        <label for="currentPassword">Contraseña actual</label>
        <div class="password-input-wrapper">
          <input id="currentPassword" formControlName="currentPassword"
            [type]="showCurrentPassword ? 'text' : 'password'" class="form-input" placeholder="Ingresar contraseña"
            [class.error]="getFieldError('currentPassword')" />
          <button type="button" class="toggle-password-btn" [class.show]="showCurrentPassword"
            (click)="togglePasswordVisibility('current')">
            👁
          </button>
        </div>
        <div class="error-message" *ngIf="getFieldError('currentPassword')">
          {{ getFieldError('currentPassword') }}
        </div>
      </div>
      <div class="forgot-password-link" [ngClass]="{'with-error-margin': getFieldError('currentPassword')}">
        <a href="#" (click)="onForgotPassword()">¿Olvidaste tu contraseña?</a>
      </div>
    </div>

    <!-- Nueva contraseña y repetir contraseña -->
    <div class="form-row">
      <div class="form-group">
        <label for="newPassword">Contraseña nueva</label>
        <div class="password-input-wrapper">
          <input id="newPassword" formControlName="newPassword" [type]="showNewPassword ? 'text' : 'password'"
            class="form-input" placeholder="Ingresar contraseña" [class.error]="getFieldError('newPassword')" />
          <button type="button" class="toggle-password-btn" (click)="togglePasswordVisibility('new')">
            <i class="" [class.show]="showNewPassword">
              👁
            </i>
          </button>
        </div>
        <!-- <div *ngIf="!getFieldError('newPassword')" >
            La contraseña es sensible a mayúsculas y minúsculas.
         </div> -->
        <div class="error-message" *ngIf="getFieldError('newPassword')">
          {{ getFieldError('newPassword') }}
        </div>
      </div>

      <div class="form-group">
        <label for="repeatPassword">Repetir contraseña</label>
        <div class="password-input-wrapper">
          <input id="repeatPassword" formControlName="repeatPassword" [type]="showConfirmPassword ? 'text' : 'password'"
            class="form-input" placeholder="Ingresar contraseña" [class.error]="getFieldError('repeatPassword')" />
          <button type="button" class="toggle-password-btn" (click)="togglePasswordVisibility('confirm')">
            <i class="" [class.show]="showConfirmPassword">
              👁
            </i>
          </button>
        </div>
        <div class="error-message" *ngIf="getFieldError('repeatPassword')">
          {{ getFieldError('repeatPassword') }}
        </div>
      </div>
    </div>

    <!-- Información de seguridad -->
    <div class="security-reminder">
      <div class="reminder-icon">
        <i class="pi icon-exclamation-circle" [ngClass]="'pi-exclamation-circle'"></i>
      </div>
      <div class="reminder-text">
        <strong>Recuerda</strong>
        <p>Para cambiar la contraseña, verifica tu contraseña actual y luego crea una nueva que no uses en otro sitio.
          Cambia la contraseña en cualquier momento que creas que sea vulnerable.</p>
      </div>
    </div>

    <!-- Checkbox para cerrar otras sesiones -->
    <div class="checkbox-group">
      <input type="checkbox" id="closeOtherSessions" [(ngModel)]="closeOtherSessions"
        [ngModelOptions]="{standalone: true}" />
      <label for="closeOtherSessions">Cerrar todas las otras sesiones</label>
    </div>

    <!-- Botones de acción -->
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" [disabled]="passwordForm.pristine" (click)="onCancel()">
        Cancelar
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="passwordForm.pristine">
        Guardar cambios
      </button>
    </div>
  </form>

  <app-modal-notify *ngIf="showModal" [title]="modalTitle" [message]="modalMessage" iconType="success"
    (closed)="onCloseModal()" />

  <app-logo-spinner [show]="isSubmitting" [fullscreen]="true" [delay]="150" [minVisible]="400"></app-logo-spinner>
</guest-panels>