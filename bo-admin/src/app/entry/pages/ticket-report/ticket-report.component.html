<div class="ticket-report-card d-flex flex-column gap-6 p-6 bg-white w-100">
	<h2 class="title">Reporte de tickets</h2>

	<div class="toolbar-card">
		<!-- Filtros -->
		<filter-generic
			[filters]="filters"
			[values]="values"
			(valuesChange)="onValuesChange($event)"
			[showActionButton]="true"
			[actionText]="actionText"
			(action)="onActionClick()"
		></filter-generic>

		<!-- Contenido -->
		<ng-container *ngIf="!loading; else loadingTemplate">
				<!-- Resumen de canjeados (con divisores arriba y abajo) -->
				<div *ngIf="isShowingTickets" class="summary-divider">
					<div class="redeemed-summary">
						<span class="redeemed-item">Canjeados: <strong>{{ redeemedCount }}</strong></span>
						<span class="redeemed-item">No canjeados: <strong>{{ notRedeemedCount }}</strong></span>
						<span class="redeemed-item">En total: <strong>{{ totalTickets }}</strong> tickets</span>
					</div>
				</div>
			<app-table-generic
				[columns]="visibleColumns"
				[keys]="visibleKeys"
				[data]="pagedData"
				[columnWidths]="visibleWidths"
				[pageIndex]="pageIndex"
				[pageSize]="pageSize"
				[showView]="false"
				[showEdit]="false"
				[showDelete]="false"
				[showActions]="false"
				[imageKeys]="[]"
				[statusKey]="''"
			></app-table-generic>

			<!-- Paginador SOLO cuando se muestran tickets -->
			<ng-container *ngIf="isShowingTickets && tickets.length > 0">
				<app-table-paginator
					[length]="totalLength"
					[pageSize]="pageSize"
					[pageIndex]="pageIndex"
					(pageChange)="onPageChange($event)"
					(pageSizeChange)="onPageSizeChange($event)"
				></app-table-paginator>
			</ng-container>

			<!-- VacÃ­os -->
			<ng-container *ngIf="isShowingTickets && tickets.length === 0">
				<app-empty-state message="No hay tickets para mostrar"></app-empty-state>
			</ng-container>

			<ng-container *ngIf="!isShowingTickets && events.length === 0">
				<app-empty-state message="No data"></app-empty-state>
			</ng-container>
		</ng-container>

		<ng-template #loadingTemplate>
			<div class="d-flex justify-content-center align-items-center py-5">
				<div class="spinner-border text-primary" role="status">
					<span class="visually-hidden">Cargando...</span>
				</div>
			</div>
		</ng-template>
	</div>
</div>

<app-modal-notify
	*ngIf="showNotify"
	[title]="notifyTitle"
	[message]="notifyMessage"
	[iconType]="notifyType"
	(closed)="showNotify = false"
></app-modal-notify>
